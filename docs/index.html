<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Poisson Lognormal Models â€¢ PLNmodels</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Poisson Lognormal Models">
<meta property="og:description" content="The Poisson-lognormal model and variants can be used for 
    a variety of multivariate problems when count data are at play (including 
    PCA for count data, discriminant analysis and network inference). This package 
    implements efficient tvariational algorithms to fit such models accompanied with a set of
    functions for visualization and diagnostic.">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">PLNmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a>
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Trichoptera.html">The trichoptera data set</a>
    </li>
    <li>
      <a href="articles/Import_data.html">Data importation in PLNmodels</a>
    </li>
    <li>
      <a href="articles/PLN.html">PLN: Multivariate Poisson regression</a>
    </li>
    <li>
      <a href="articles/PLNPCA.html">PLNPCA: Dimension Reduction</a>
    </li>
    <li>
      <a href="articles/PLNnetwork.html">PLNnetwork: sparse structure inference</a>
    </li>
    <li>
      <a href="articles/PLNLDA.html">PLNLDA: Discriminant Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jchiquet/PLNmodels">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<div id="plnmodels-poisson-lognormal-models" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#plnmodels-poisson-lognormal-models" class="anchor"></a>PLNmodels: Poisson lognormal models <img src="reference/figures/logo.png" align="right" width="155" height="180">
</h1></div>

<blockquote>
<p>The Poisson lognormal model and variants can be used for a variety of multivariate problems when count data are at play (including PCA, LDA and network inference for count data). This package implements efficient algorithms to fit such models accompanied with a set of functions for vizualisation and diagnostic.</p>
</blockquote>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div id="system-requirements" class="section level3">
<h3 class="hasAnchor">
<a href="#system-requirements" class="anchor"></a>System Requirements</h3>
<p>Installation requires a system version of <a href="https://nlopt.readthedocs.io/">nlopt 2.4-2</a></p>
<p>On <strong>Debian</strong> or <strong>Ubuntu</strong> use <code>libnlopt-dev</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="fu">sudo</span> apt-get install libnlopt-dev</a></code></pre></div>
<p>On <strong>Debian testing</strong> use <code>libnlopt-cxx-dev</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="fu">sudo</span> apt-get install libnlopt-cxx-dev</a></code></pre></div>
<p>On <strong>Fedora</strong> or similar use <code>NLopt-devel</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="fu">sudo</span> yum install NLopt-devel</a></code></pre></div>
<p>With <strong>Mac OS X</strong>, install <code>nlopt</code> via <a href="https://brew.sh/">homebrew</a></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="ex">brew</span> install nlopt</a></code></pre></div>
<p>On <strong>Windows</strong>, the package builds and installs correctly by <a href="https://github.com/rwinlib/nlopt">including static libraries</a> on compilation.</p>
</div>
<div id="r-package-installation" class="section level3">
<h3 class="hasAnchor">
<a href="#r-package-installation" class="anchor"></a>R Package installation</h3>
<div id="cran-dependencies" class="section level4">
<h4 class="hasAnchor">
<a href="#cran-dependencies" class="anchor"></a>CRAN dependencies</h4>
<p><strong>PLNmodels</strong> needs the following CRAN R packages, so check that their are installed on your computer.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(R6)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(glassoFast)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(Matrix)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(Rcpp)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(RcppArmadillo)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(igraph)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(grid)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gridExtra)</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(corrplot)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(magrittr)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co"># use install.packages() if needed</span></a></code></pre></div>
</div>
<div id="bioconductor-dependencies" class="section level4">
<h4 class="hasAnchor">
<a href="#bioconductor-dependencies" class="anchor"></a>Bioconductor dependencies</h4>
<p><strong>PLNmodels</strong> also needs two BioConductor packages</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(phyloseq)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(biomformat)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">## use BiocManager::install() if needed</span></a></code></pre></div>
</div>
<div id="installing-plnmodels" class="section level4">
<h4 class="hasAnchor">
<a href="#installing-plnmodels" class="anchor"></a>Installing PLNmodels</h4>
<ul>
<li>For the last tagged release, use</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"jchiquet/PLNmodels@v0.7.0.2"</span>)</a></code></pre></div>
<ul>
<li><p>Windows users may want to use <a href="https://github.com/jchiquet/PLNmodels/releases/download/v0.7.0.2/PLNmodels_0.7.0.2.zip">the binary version of the package</a></p></li>
<li><p>For the development version, use</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"jchiquet/PLNmodels"</span>)</a></code></pre></div>
</div>
</div>
</div>
<div id="usage-and-main-fitting-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#usage-and-main-fitting-functions" class="anchor"></a>Usage and main fitting functions</h2>
<p>The package comes with a ecological data to present the functionality</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(PLNmodels)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(trichoptera)</a></code></pre></div>
<p>The main fitting functions work with the usual <code>R formula</code> notations, with mutivariate responses on the left hand side. You probably want to start by one of them. Check the corresponding vignette and documentation page. There is a dedicated vignettes for each model in the package (See <a href="http://jchiquet.github.io/PLNmodels/articles/" class="uri">http://jchiquet.github.io/PLNmodels/articles/</a>).</p>
<div id="unpenalized-poisson-lognormal-model-aka-pln" class="section level3">
<h3 class="hasAnchor">
<a href="#unpenalized-poisson-lognormal-model-aka-pln" class="anchor"></a>Unpenalized Poisson lognormal model (aka PLN)</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">myPLN &lt;-<span class="st"> </span><span class="kw"><a href="reference/PLN.html">PLN</a></span>(Abundance <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> trichoptera)</a></code></pre></div>
</div>
<div id="rank-contraint-poisson-lognormal-for-poisson-principal-component-analysis-aka-plnpca" class="section level3">
<h3 class="hasAnchor">
<a href="#rank-contraint-poisson-lognormal-for-poisson-principal-component-analysis-aka-plnpca" class="anchor"></a>Rank Contraint Poisson lognormal for Poisson Principal Component Analysis (aka PLNPCA)</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">myPCA &lt;-<span class="st"> </span><span class="kw"><a href="reference/PLNPCA.html">PLNPCA</a></span>(Abundance <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> trichoptera, <span class="dt">ranks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)</a></code></pre></div>
</div>
<div id="poisson-lognormal-discriminant-analysis-aka-plnlda" class="section level3">
<h3 class="hasAnchor">
<a href="#poisson-lognormal-discriminant-analysis-aka-plnlda" class="anchor"></a>Poisson lognormal discriminant analysis (aka PLNLDA)</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">myLDA &lt;-<span class="st"> </span><span class="kw"><a href="reference/PLNLDA.html">PLNLDA</a></span>(Abundance <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">grouping =</span> trichoptera<span class="op">$</span>Group, <span class="dt">data =</span> trichoptera)</a></code></pre></div>
</div>
<div id="sparse-poisson-lognormal-model-for-sparse-covariance-inference-for-counts-aka-plnnetwork" class="section level3">
<h3 class="hasAnchor">
<a href="#sparse-poisson-lognormal-model-for-sparse-covariance-inference-for-counts-aka-plnnetwork" class="anchor"></a>Sparse Poisson lognormal model for sparse covariance inference for counts (aka PLNnetwork)</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">myPLNnetwork &lt;-<span class="st"> </span><span class="kw"><a href="reference/PLNnetwork.html">PLNnetwork</a></span>(Abundance <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> trichoptera)</a></code></pre></div>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Please cite our work using the following references:</p>
<ul>
<li><p>J. Chiquet, M. Mariadassou and S. Robin: Variational inference for probabilistic Poisson PCA, the Annals of Applied Statistics, 12: 2674â€“2698, 2018. <a href="http://dx.doi.org/10.1214/18-AOAS1177">link</a></p></li>
<li><p>J. Chiquet, M. Mariadassou and S. Robin: Variational inference for sparse network reconstruction from count data, arXiv preprint, 2018. <a href="https://arxiv.org/abs/1806.03120">link</a></p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Report a bug at <br><a href="https://github.com/jchiquet/PLNmodels/issues">https://â€‹github.com/â€‹jchiquet/â€‹PLNmodels/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing PLNmodels</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Julien Chiquet <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3629-3429" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID" height="16"></a> </li>
<li>Mahendra Mariadassou <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2986-354X" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID" height="16"></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/jchiquet/PLNmodels"><img src="https://travis-ci.org/jchiquet/PLNmodels.svg?branch=master" alt="Travis-CI build status"></a></li>
<li><a href="https://ci.appveyor.com/project/jchiquet/PLNmodels"><img src="https://ci.appveyor.com/api/projects/status/github/jchiquet/PLNmodels?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://www.codacy.com/app/jchiquet/PLNmodels?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=jchiquet/PLNmodels&amp;utm_campaign=Badge_Grade"><img src="https://api.codacy.com/project/badge/Grade/c031ad73ccdb4c88ba11dfd74fab1255" alt="Codacy Badge"></a></li>
<li><a href="https://codecov.io/github/jchiquet/PLNmodels?branch=master"><img src="https://codecov.io/gh/jchiquet/PLNmodels/branch/master/graph/badge.svg" alt="Coverage status"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Julien Chiquet, Mahendra Mariadassou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
