<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyzing the Trichopetra data set with Poisson log-normal PCA • PLNmodels</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing the Trichopetra data set with Poisson log-normal PCA">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PLNmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">articles</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jchiquet/PLNmodels">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Analyzing the Trichopetra data set with Poisson log-normal PCA</h1>
                        <h4 class="author">Julien Chiquet</h4>
            
            <h4 class="date">2018-11-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jchiquet/PLNmodels/blob/master/vignettes/PLNPCA_trichoptera.Rmd"><code>vignettes/PLNPCA_trichoptera.Rmd</code></a></small>
      <div class="hidden name"><code>PLNPCA_trichoptera.Rmd</code></div>

    </div>

    
    
<p>This vignette intends to illustrate the basical use of the <code>PLNPCA</code> function and the methods accompaning the R6 Classes <code>PLNPCAfamily</code> and <code>PLNPCAfit</code>. To this end, let us consider an ecological data set concerning abundances of Trichopetera species, coupled with some meteological factors that may influence the presence their presence.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(PLNmodels)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(trichoptera)</a></code></pre></div>
<p>See <code><a href="../reference/trichoptera.html">?PLNmodels::trichoptera</a></code> for details.</p>
<div id="poisson-log-normal-models" class="section level2">
<h2 class="hasAnchor">
<a href="#poisson-log-normal-models" class="anchor"></a>Poisson log-normal models</h2>
<p>The family of models available in the package belongs to the family of probabilistic PCA models, where the observation are not necessarily Gaussian. In particular, we consider that observations are drawn from a Poisson distribution. All mathematical details can be found in <span class="citation">Chiquet, Mariadassou, and Robin (<a href="#ref-PLNPCA">2018</a>)</span>.</p>
<div id="a-quick-view-of-the-mathematical-formulation-of-the-model" class="section level3">
<h3 class="hasAnchor">
<a href="#a-quick-view-of-the-mathematical-formulation-of-the-model" class="anchor"></a>A quick view of the mathematical formulation of the model</h3>
<p>The model can be written in a hierachical framework where a sample of <span class="math inline">\(p\)</span>-dimensional observation vectors <span class="math inline">\(\mathbf{Y}_i\)</span> is related to some <span class="math inline">\(q\)</span>-dimensional vectors of latent variables <span class="math inline">\(\mathbf{W}_i\)</span> as follows <span class="math display">\[\begin{equation} 
  \label{eq:pca-model}
  \begin{array}{rcl}
    \text{latent space }  &amp; \mathbf{W}_i \quad \text{i.i.d.} &amp; \mathbf{W}_i \sim      \mathcal{N}(\mathbf{0}_q, \mathbf{I}_q)  \\
\text{parameter space } &amp;   \mathbf{Z}_i = {\boldsymbol\mu} + \mathbf{B}^\top \mathbf{W}_i &amp; \\
  \text{observation space } &amp;  Y_{ij} | Z_{ij} \quad \text{indep.} &amp; Y_{ij} | Z_{ij} \sim \mathcal{P}\left(\exp\{Z_{ij}\}\right)
  \end{array}
\end{equation}\]</span></p>
<p>The parameter <span class="math inline">\({\boldsymbol\mu}\)</span> corresponds to the main effects, <span class="math inline">\(\mathbf{B}\)</span> to  loadings in the parameter spaces and <span class="math inline">\(\mathbf{W}_i\)</span> to scores of the <span class="math inline">\(i\)</span>-th observation in the low-dimensional latent subspace of the parameter space. For more details, have a look at our research paper referenced in the package documentation.</p>
<p>The dimension of the latent space <span class="math inline">\(q\)</span> corresponds to the number of axes in the PCA or, in other words, to the rank of <span class="math inline">\(\mathbf{B}\mathbf{B}^\intercal\)</span>.</p>
</div>
<div id="a-model-with-latent-main-effects-for-the-trichopetra-data-set" class="section level3">
<h3 class="hasAnchor">
<a href="#a-model-with-latent-main-effects-for-the-trichopetra-data-set" class="anchor"></a>A model with latent main effects for the Trichopetra data set</h3>
<p>We start by adjusting the above model to Trichoptera data set. Here, the matrix of observations <span class="math inline">\(\mathbf{Y}\)</span> corresponds to the abundance of each species in each trapping night.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(trichoptera<span class="op">$</span>Abundance)</a></code></pre></div>
<pre><code>##  'AsIs' num [1:49, 1:17] 0 0 0 0 0 0 0 0 0 0 ...
##  - attr(*, "dimnames")=List of 2
##   ..$ : chr [1:49] "1" "2" "3" "4" ...
##   ..$ : chr [1:17] "Che" "Hyc" "Hym" "Hys" ...</code></pre>
<p>It seems also natural to add an offset corresponding to the total count per night.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">TotalCount &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colSums">rowSums</a></span>(trichoptera<span class="op">$</span>Abundance),</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  <span class="dt">nrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(trichoptera<span class="op">$</span>Abundance),</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  <span class="dt">ncol =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(trichoptera<span class="op">$</span>Abundance)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">)</a></code></pre></div>
<p>The model can be fitted with the function <code>PLNPCA</code> for a series of values for <span class="math inline">\(q\)</span> as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">models.nocov &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PLNPCA.html">PLNPCA</a></span>(Abundance <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/offset">offset</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">log</a></span>(TotalCount)), <span class="dt">data =</span> trichoptera, <span class="dt">ranks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## 
##  Initialization...
## 
##  Adjusting 5 PLN models for PCA analysis.
##   Rank approximation = 1 
     Rank approximation = 2 
     Rank approximation = 3 
     Rank approximation = 4 
     Rank approximation = 5 
##  Post-treatments
##  DONE!</code></pre>
<p>Note the use of the <code>formula</code> object to specify the model: the vector <span class="math inline">\(\boldsymbol\mu\)</span> of main effects in the mathematical formulation (one per column species) is specified in the call with the formula <code>~ 1</code>.</p>
<p>The <code>model.nocov</code> variable is an <code>R6</code> object with class <code>PLNPCAfamily</code>, which comes with a couple of methods. The most basic is the <code>show/print</code> method, which send a very basic summary of the estimation process:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">models.nocov</a></code></pre></div>
<pre><code>## --------------------------------------------------------
## COLLECTION OF 5 POISSON LOGNORMAL MODELS
## --------------------------------------------------------
##  Task: Principal Component Analysis
## ========================================================
##  - Ranks considered: from 1 to 5 
##  - Best model (regarding BIC): rank = 4 - R2 = 0.86 
##  - Best model (regarding ICL): rank = 3 - R2 = 0.8</code></pre>
<p>Complementary information comes with the <code>plot</code> method:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">models.nocov<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>()</a></code></pre></div>
<p><img src="PLNPCA_trichoptera_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>The critetion <span class="math inline">\(J\)</span> represents the variational lower bound of the likelihood: in this case, we can see that it is strictly increasing with the number of axes (or subspace dimension). Also note the (approximated) <span class="math inline">\(R^2\)</span> which is displayed for each value of <span class="math inline">\(q\)</span> (see the paper for details on how ot is computed). Generally, smoothness of these criteria is an good indicator to check that the optimization process went well.</p>
<p>From this plot, we can see that the best model in terms of BIC or ICL is obtained for <span class="math inline">\(q=4\)</span> axes. We may extract the corresponding model with the method <code>getBestModel("ICL")</code>. A model with a specific number of axes can be extracted with the <code>getModel(q)</code> method.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">myPCA.ICL &lt;-<span class="st"> </span>models.nocov<span class="op">$</span><span class="kw">getBestModel</span>(<span class="st">"ICL"</span>) <span class="co"># if no criteria is specified, the best BIC is used</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">myPCA.q3 &lt;-<span class="st"> </span>models.nocov<span class="op">$</span><span class="kw">getModel</span>(<span class="dv">3</span>) </a></code></pre></div>
<p>The variables <code>myPCA.ICL</code> and <code>myPCA.q3</code> are other <code>R6Class</code> objects of class <code>PLNPCAfit</code> which in turns owns a couple of methods, mostly for vizualization purposes. The <code>plot_PCA</code> method provides the individual maps and correlation circles as in usual PCA. If an additional classification exist for the observations – which is the case here with the available classification of the trapping nights – , it can be passed as an argument of the function.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">myPCA.ICL<span class="op">$</span><span class="kw">plot_PCA</span>(<span class="dt">cols =</span> trichoptera<span class="op">$</span>Group)</a></code></pre></div>
<p><img src="PLNPCA_trichoptera_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
<p>With our model (and any pPCA model for count data, where model are not necessarily nested), it is important to look at all the axes at the same time, since the model with <span class="math inline">\(q=3\)</span> axes is not included in the model with <span class="math inline">\(q=5\)</span> axes. Indeed, let us vizualize first three axes for the model with <span class="math inline">\(q=5\)</span> (note that we can control the axes which are plotted):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">myPCA.q3<span class="op">$</span><span class="kw">plot_PCA</span>(<span class="dt">cols =</span> trichoptera<span class="op">$</span>Group, <span class="dt">axes=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="PLNPCA_trichoptera_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<p>We can see that the maps for axes (1,2) is slightly different for the model with <span class="math inline">\(q=3\)</span> from the one obtained for axes (1,2) in the <span class="math inline">\(q=3\)</span> model.</p>
<p>Also, percentage of variance must be interpreted with care: it sums to 100% but must be put in perspective with the model <span class="math inline">\(R^2\)</span>, giving an approximation of the total percentage of variance explained with the current model.</p>
</div>
<div id="a-model-accounting-for-meteorological-covariates-in-the-trichopetra-data-set" class="section level3">
<h3 class="hasAnchor">
<a href="#a-model-accounting-for-meteorological-covariates-in-the-trichopetra-data-set" class="anchor"></a>A model accounting for meteorological covariates in the Trichopetra data set</h3>
<p>An original contribution of our model is to let the possibility of taking into account some covariates in the parameter space. Such a strategy often completly changes the interpretation of PCA. Indeed, the covariates are often responsible for some strong structure in the data. The effect of the covariates should be removed since they are often quite obvious for the analyst and may hide some more important and subtile effects.</p>
<p>Basically, the model with covariates extends the one used in the previous section by modeling the parameter space as follows:</p>
<p><span class="math display">\[\begin{equation} 
  \mathbf{Z}_i = {\boldsymbol\mu} + {\boldsymbol\Theta} \mathbf{X}_i^\intercal +    \mathbf{B}^\top \mathbf{W}_i, \qquad \mathbf{Z}_i \sim \mathcal{N}({\boldsymbol\mu} + {\boldsymbol\Theta} \mathbf{X}_i^\intercal, \mathbf{B}\mathbf{B}^\top),
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mathbf{X}_i\)</span> is a vector of <span class="math inline">\(d\)</span> covariate for observations <span class="math inline">\(i\)</span>. The <span class="math inline">\(p \times d\)</span> matrix <span class="math inline">\(\boldsymbol\Theta\)</span> entails the associated parameters.</p>
<p>In the case at hand, the covariates corresponds to the meteorological variables. Let us try to introduce some of them in our model, for instance, the minimal temperature, the wind and the average cloudiness This can be done thanks to the model formula:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">models.cov &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PLNPCA.html">PLNPCA</a></span>(Abundance <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/offset">offset</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">log</a></span>(TotalCount)) <span class="op">+</span><span class="st"> </span>T_min <span class="op">+</span><span class="st"> </span>Wind <span class="op">+</span><span class="st"> </span>Cloudiness_average, <span class="dt">data =</span> trichoptera, <span class="dt">ranks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## 
##  Initialization...
## 
##  Adjusting 5 PLN models for PCA analysis.
##   Rank approximation = 1 
     Rank approximation = 2 
     Rank approximation = 3 
     Rank approximation = 4 
     Rank approximation = 5 
##  Post-treatments
##  DONE!</code></pre>
<p>Again, the best model is obtained for <span class="math inline">\(q=3\)</span> classes.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">models.cov</a></code></pre></div>
<pre><code>## --------------------------------------------------------
## COLLECTION OF 5 POISSON LOGNORMAL MODELS
## --------------------------------------------------------
##  Task: Principal Component Analysis
## ========================================================
##  - Ranks considered: from 1 to 5 
##  - Best model (regarding BIC): rank = 3 - R2 = 0.73 
##  - Best model (regarding ICL): rank = 3 - R2 = 0.73</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">myPCA.cov &lt;-<span class="st"> </span>models.cov<span class="op">$</span><span class="kw">getBestModel</span>(<span class="st">"ICL"</span>)</a></code></pre></div>
<p>The <code>show/print</code> method lists a few summary statistics and useful methods / fields.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">myPCA.cov</a></code></pre></div>
<pre><code>## Poisson Lognormal with rank constrained for PCA (rank = 3)
## ==================================================================
##  degrees_freedom    loglik       BIC       ICL R_squared
##              119 -963.6623 -1195.226 -1270.007 0.7339339
## ==================================================================
## * Useful fields 
##     $model_par, $fitted, $latent, $var_par, $optim_par 
##     $loglik, $BIC, $ICL, $loglik_vec, $degrees_freedom, $criteria 
## * Useful S3 methods
##     plot(), print(), vcov(), coef(), predict()
## * Additional fields for PCA
##     $percent_var, $corr_circle, $scores, $rotation 
## * Additional methods for PCA
##     $plot_PCA(), $plot_correlation_circle(), $plot_individual_map()</code></pre>
<p>Suppose that we want to give a closer look to the first two axes. This can be done thanks to the two methods <code>plot_individual_map</code> and <code>plot_correlation_circle</code> :</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">myPCA.cov<span class="op">$</span><span class="kw">plot_individual_map</span>(<span class="dt">axes=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">cols=</span>trichoptera<span class="op">$</span>Group)</a></code></pre></div>
<p><img src="PLNPCA_trichoptera_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">myPCA.cov<span class="op">$</span><span class="kw">plot_correlation_circle</span>(<span class="dt">axes=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))</a></code></pre></div>
<p><img src="PLNPCA_trichoptera_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
<div id="data-structure-of-a-plnpcafit-model" class="section level3">
<h3 class="hasAnchor">
<a href="#data-structure-of-a-plnpcafit-model" class="anchor"></a>Data structure of a <code>PLNPCAfit</code> model</h3>
<p><code>myPCA.cov</code> is an object of class <code>PLNPCAfit</code> with several fields, in addition to the two plot methods previously mentioned. Among the many fields, the most interesting for the end-user are</p>
<ul>
<li>the regression coefficient matrix</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(myPCA.cov))</a></code></pre></div>
<pre><code>##     (Intercept)       T_min        Wind Cloudiness_average
## Che -19.4092492  0.62860393 -0.79222483       -0.022023416
## Hyc -18.1052394  0.43620807  0.13965231        0.037719587
## Hym  -2.6382806 -0.10549199 -0.20558352        0.022250198
## Hys  -7.8044916 -0.03381157 -0.56867780        0.018272206
## Psy  -0.2588776 -0.00864431  0.03612101       -0.002650577
## Aga  -2.5488638 -0.12639033 -0.02919774        0.008379871</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co">## Or equivalently</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">## head(myPCA.cov$model_par$B)</span></a></code></pre></div>
<ul>
<li>the rotation matrix (in the latent space)</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(myPCA.cov<span class="op">$</span>rotation)</a></code></pre></div>
<pre><code>##            [,1]        [,2]        [,3]
## Che  0.50536480 -0.10892115 -0.14831942
## Hyc -0.59440290 -0.12252759 -0.30965163
## Hym -0.02673406 -0.03325373 -0.14447329
## Hys -0.11356574  0.18406229 -0.33371737
## Psy  0.03795112  0.03630391  0.04166303
## Aga  0.05104475 -0.04612667 -0.42855257</code></pre>
<ul>
<li>the principal components values (or scores)</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(myPCA.cov<span class="op">$</span>scores)</a></code></pre></div>
<pre><code>##        [,1]       [,2]       [,3]
## 1 -3.195751  0.3600483 -0.2449149
## 2  1.954188 -1.0312855  0.4784672
## 3  4.190046 -1.6800055  1.5903460
## 4  4.980261 -0.3997048  2.1878175
## 5  3.413255  0.1883234  0.5911391
## 6  4.549632 -0.7701306  0.5130351</code></pre>
<p>That is all for now!</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-PLNPCA">
<p>Chiquet, Julien, Mahendra Mariadassou, and Stéphane Robin. 2018. “Variational Inference for Probabilistic Poisson Pca.” <em>The Annals of Applied Statistics</em> 12: 2674–98. <a href="http://dx.doi.org/10.1214/18-AOAS1177">http://dx.doi.org/10.1214/18-AOAS1177</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#poisson-log-normal-models">Poisson log-normal models</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Julien Chiquet, Mahendra Mariadassou, Stéphane Robin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
