<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PLNmodels: mathematical background and companion data set • PLNmodels</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="PLNmodels: mathematical background and companion data set">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PLNmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.9605</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles and Vignettes</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jchiquet/PLNmodels">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>PLNmodels: mathematical background and companion data set</h1>
                        <h4 class="author">PLN team</h4>
            
            <h4 class="date">2018-12-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jchiquet/PLNmodels/blob/master/vignettes/PLNmodels_introduction.Rmd"><code>vignettes/PLNmodels_introduction.Rmd</code></a></small>
      <div class="hidden name"><code>PLNmodels_introduction.Rmd</code></div>

    </div>

    
    
<p>This vignette provides mathematical insights for all the statistical models used in the package <strong>PLNmodels</strong>. We also give basic description of the <code>trichoptera</code> data set, which is used all along the package in the vignettes and the documentation examples.</p>
<div id="motivations" class="section level2">
<h2 class="hasAnchor">
<a href="#motivations" class="anchor"></a>Motivations</h2>
<p>In <strong>PLNmodels</strong>, the top-level functions (<code>PLN</code>, <code>PLNPCA</code>, <code>PLNLDA</code>, <code>PLNnetwork</code>) are dedicted to several common tasks of multivariate analysis (regression, dimension reduction, clustering, structure inference). Contrary to many standard tools of multivariate analysis (PCA, LDA or Gaussian Graphical Models, see <span class="citation">Mardia, Kent, and Bibby (1979)</span>), which assume a multivariate Gaussian distribution of the data, the family of models used in <strong>PLNmodels</strong> – based on the multivariate Poisson Lognormal (PLN) distribution <span class="citation">(Aitchison and Ho 1989)</span> – are specific to tables of counts. Such data are common in many application fields such as ecology (abundance table), or genomics (single cell sequencing). These data often come with some external knowledge (via covariates and offsets) which should be taken into account during the fits.</p>
<p>We first quickly review the PLN model from the mathematical side. In a second time, we present a simple dataset from ecology that fulfills all the characteristics described above.</p>
</div>
<div id="mathematical-background" class="section level2">
<h2 class="hasAnchor">
<a href="#mathematical-background" class="anchor"></a>Mathematical Background</h2>
<p>The multivariate Poisson lognormal model <span class="citation">(in short PLN, see Aitchison and Ho 1989)</span> is the building block for all the multivariate models found in the <strong>PLNmodels</strong> package. It relates some <span class="math inline">\(p\)</span>-dimensional observation vectors <span class="math inline">\(\mathbf{Y}_i\)</span> to some <span class="math inline">\(p\)</span>-dimensional vectors of Gaussian latent variables <span class="math inline">\(\mathbf{Z}_i\)</span> as follows <span class="math display">\[\begin{equation}
  \label{eq:pln-model}
  \begin{array}{rcl}
  \text{latent space } &amp;   \mathbf{Z}_i \sim \mathcal{N}({\boldsymbol\mu},\boldsymbol\Sigma), \\
  \text{observation space } &amp;  Y_{ij} | Z_{ij} \quad \text{indep.} &amp;   \mathbf{Y}_i | \mathbf{Z}_i\sim\mathcal{P}\left(\exp\{\mathbf{Z}_i\}\right).
  \end{array}
\end{equation}\]</span></p>
<p>The parameter <span class="math inline">\({\boldsymbol\mu}\)</span> corresponds to the main effects and the latent covariance matrix <span class="math inline">\(\boldsymbol\Sigma\)</span> describes the underlying structure of dependence between the <span class="math inline">\(p\)</span> variables.</p>
<p>This model generalizes naturally to a formulation closer to a multivariate generalized linear model, where the main effect is due to a linear combination of <span class="math inline">\(d\)</span> covariates <span class="math inline">\(\mathbf{x}_i\)</span>. We also let the possibility to add some offsets for the <span class="math inline">\(d\)</span> variables and in each sample., that is <span class="math inline">\(\mathbf{o}_i\)</span>. Hence, model  generalizes to</p>
<p><span class="math display">\[\begin{equation}
  \label{eq:pln-model-glm}
  \mathbf{Y}_i | \mathbf{Z}_i \sim \mathcal{P}\left(\exp\{\mathbf{Z}_i\}\right), \qquad \mathbf{Z}_i \sim \mathcal{N}({\mathbf{o}_i + \mathbf{x}_i^\top\boldsymbol\Theta},\boldsymbol\Sigma), \\
\end{equation}\]</span> where <span class="math inline">\(\boldsymbol\Theta\)</span> is a <span class="math inline">\(d\times p\)</span> matrix of regression parameters. At the end of the day, the data matrices available to feed the model are</p>
<ul>
<li>the <span class="math inline">\(n\times p\)</span> matrix of counts <span class="math inline">\(\mathbf{Y}\)</span>
</li>
<li>the <span class="math inline">\(n\times p\)</span> matrix of covariates <span class="math inline">\(\mathbf{X}\)</span>
</li>
<li>the <span class="math inline">\(n\times p\)</span> matrix of offsets <span class="math inline">\(\mathbf{O}\)</span>
</li>
</ul>
</div>
<div id="the-trichoptera-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#the-trichoptera-dataset" class="anchor"></a>The trichoptera dataset</h2>
<p>The trichoptera data set <span class="citation">(Usseglio-Polatera and Auda 1987)</span> is an ecological data set describing abundances of Trichopetera species, accompanied with some meteological factors that may influence the presence their presence (hereafter the <em>covariates</em>). It is included in the package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(PLNmodels)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(trichoptera)</a></code></pre></div>
<p>Additional details are available to the user by <code><a href="../reference/trichoptera.html">?PLNmodels::trichoptera</a></code>: <code>trichoptera</code> is a data frame including 49 rows (the observations - or trapping nights) and 14 columns: 2 multivariate columns (for counts and offsets) and 12 univariate columns (the covariates).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(trichoptera)</a></code></pre></div>
<pre><code>##  [1] "Abundance"           "T_max"               "T_evening"          
##  [4] "T_min"               "Wind"                "Pressure"           
##  [7] "Pressure_range"      "Humidity"            "Cloudiness_night"   
## [10] "Precipitation_night" "Cloudiness_average"  "Precipitation_total"
## [13] "Group"               "TotalCounts"</code></pre>
<ul>
<li>The <code>Abundance</code> column is a <span class="math inline">\(49 \times 17\)</span> matrix of abundancies (or counts) for each 17 species during the 49 trapping nights (<span class="math inline">\(\mathbf{Y}\)</span> in the mathematical model):</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(trichoptera<span class="op">$</span>Abundance)</a></code></pre></div>
<pre><code>##   Che Hyc Hym Hys Psy Aga Glo Ath Cea Ced Set All Han Hfo Hsp Hve Sta
## 1   0   0   5   0  17   0   0   0   0   2   0   1   0   1   2   0   1
## 2   0   0   3   0   8   0   0   0   0   0   0   2   0   0   0   0   0
## 3   0   0   1   0  32   0   0   0   0   0   0   4   0   0   1   0   0
## 4   0   0   3   0 176   4   0   0   0   1   0   3   0   0   3   0   2
## 5   0   0   4   0  69   2   0   0   0   0   0   1   0   0   1   0   2
## 6   0   0   2   0  14   1   0   0   0   0   0   1   0   0   0   0   0</code></pre>
<ul>
<li>In order to correct for the sampling effort, it is natural to use an offset term for each observation that corresponds to the total counts per night, specified by a <span class="math inline">\(49 \times 17\)</span> matrix of offsets<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> (matrix <span class="math inline">\(\mathbf{O}\)</span> in model). The corresponding column is named <code>TotalCounts</code> in the data frame:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(trichoptera<span class="op">$</span>TotalCounts)</a></code></pre></div>
<pre><code>##   Che Hyc Hym Hys Psy Aga Glo Ath Cea Ced Set All Han Hfo Hsp Hve Sta
## 1  29  29  29  29  29  29  29  29  29  29  29  29  29  29  29  29  29
## 2  13  13  13  13  13  13  13  13  13  13  13  13  13  13  13  13  13
## 3  38  38  38  38  38  38  38  38  38  38  38  38  38  38  38  38  38
## 4 192 192 192 192 192 192 192 192 192 192 192 192 192 192 192 192 192
## 5  79  79  79  79  79  79  79  79  79  79  79  79  79  79  79  79  79
## 6  18  18  18  18  18  18  18  18  18  18  18  18  18  18  18  18  18</code></pre>
<ul>
<li>The 12 remaning colums are covariates that can be used to form design matrix <span class="math inline">\(\mathbf{X}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(trichoptera[, <span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">14</span>)])</a></code></pre></div>
<pre><code>##   T_max T_evening T_min Wind Pressure Pressure_range Humidity
## 1  22.2      18.7  11.0 -2.3    998.5            4.1       60
## 2  24.2      19.8   8.4 -2.7    999.5           -1.1       63
## 3  27.4      22.0  11.0 -0.7    997.2           -3.6       73
## 4  29.0      23.0  12.6  2.3    991.1           -6.2       71
## 5  28.2      22.5  12.0  2.3    990.1            1.7       62
## 6  28.0      23.9  13.8 -2.0    990.1           -0.8       64
##   Cloudiness_night Precipitation_night Cloudiness_average
## 1               19                   0                 17
## 2                0                   0                 27
## 3                6                   0                 13
## 4               81                   0                 52
## 5               50                   0                 34
## 6               50                   0                 36
##   Precipitation_total Group
## 1                   0     1
## 2                   0     1
## 3                   0     1
## 4                   0     1
## 5                   0     1
## 6                   0     1</code></pre>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-AiH89">
<p>Aitchison, J., and C.H. Ho. 1989. “The Multivariate Poisson-Log Normal Distribution.” <em>Biometrika</em> 76 (4). Oxford University Press: 643–53.</p>
</div>
<div id="ref-MKB79">
<p>Mardia, K.V., J.T. Kent, and J.M. Bibby. 1979. <em>Multivariate Analysis</em>. Academic press.</p>
</div>
<div id="ref-trichoptera">
<p>Usseglio-Polatera, P., and Y. Auda. 1987. “Influence Des Facteurs Météorologiques Sur Les Résultats de Piégeage Lumineux.” In <em>Annales de Limnologie-International Journal of Limnology</em>, 23:65–79. 1. EDP Sciences.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Note that the offset term remains the same in a given sample albeit sometimes one might include an offset specific to both the sample and the species.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#motivations">Motivations</a></li>
      <li><a href="#mathematical-background">Mathematical Background</a></li>
      <li><a href="#the-trichoptera-dataset">The trichoptera dataset</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Julien Chiquet, Mahendra Mariadassou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
