<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute offsets from a count data using one of several normalization schemes — compute_offset • PLNmodels</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute offsets from a count data using one of several normalization schemes — compute_offset" />
<meta property="og:description" content="Computes offsets from the count table using one of several normalization schemes (TSS, CSS, RLE, GMPR, etc) described in the literature." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PLNmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.3.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a>
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Trichoptera.html">The trichoptera data set</a>
    </li>
    <li>
      <a href="../articles/Import_data.html">Data importation in PLNmodels</a>
    </li>
    <li>
      <a href="../articles/PLN.html">PLN: Multivariate Poisson regression</a>
    </li>
    <li>
      <a href="../articles/PLNPCA.html">PLNPCA: Dimension Reduction</a>
    </li>
    <li>
      <a href="../articles/PLNnetwork.html">PLNnetwork: sparse structure inference</a>
    </li>
    <li>
      <a href="../articles/PLNLDA.html">PLNLDA: Discriminant Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jchiquet/PLNmodels">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute offsets from a count data using one of several normalization schemes</h1>
    
    <div class="hidden name"><code>compute_offset.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes offsets from the count table using one of several normalization schemes (TSS, CSS, RLE, GMPR, etc) described in the literature.</p>
    </div>

    <pre class="usage"><span class='fu'>compute_offset</span>(<span class='no'>counts</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"TSS"</span>, <span class='st'>"GMPR"</span>, <span class='st'>"RLE"</span>, <span class='st'>"CSS"</span>, <span class='st'>"none"</span>), <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>counts</th>
      <td><p>Required. An abundance count table, preferably with dimensions names and species as columns.</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>Optional. Normalisation scheme used to compute scaling factors used as offset during PLN inference. Available schemes are "TSS" (Total Sum Scaling, default), "CSS" (Cumulative Sum Scaling, used in metagenomeSeq), "RLE" (Relative Log Expression, used in DESeq2), "GMPR" (Geometric Mean of Pairwise Ratio, introduced in Chen et al., 2018) or "none". Alternatively the user can supply its own vector or matrix of offsets (see note for specification of the user-supplied offsets).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters passed on to specific methods (for now CSS and RLE)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If offset = "none", NULL else a vector of length <code><a href='https://rdrr.io/r/base/nrow.html'>nrow(counts)</a></code> with one offset per sample.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>RLE has an additional <code>pseudocounts</code> arguments to add pseudocounts to the observed counts (defaults to 0). CSS has an additional <code>reference</code> argument to choose the location function used to compute the reference quantiles (defaults to <code>median</code> as in the Nature publication but can be set to <code>mean</code> to reproduce behavior of functions cumNormStat* from metagenomeSeq). Note that (i) CSS normalization fails when the median absolute deviation around quantiles does not become instable for high quantiles (limited count variations both within and across samples) and/or one sample has less than two positive counts, (ii) RLE fails when there are no common species across all samples and (iii) GMPR fails if a sample does not share any species with all other samples.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chen, L., Reeve, J., Zhang, L., Huang, S., Wang, X. and Chen, J. (2018) GMPR: A robust normalization method for zero-inflated count data with application to microbiome sequencing data. PeerJ, 6, e4600 <a href='https://doi.org/10.7717/peerj.4600'>https://doi.org/10.7717/peerj.4600</a></p>
<p>Paulson, J. N., Colin Stine, O., Bravo, H. C. and Pop, M. (2013) Differential abundance analysis for microbial marker-gene surveys. Nature Methods, 10, 1200-1202 <a href='http://dx.doi.org/10.1038/nmeth.2658'>http://dx.doi.org/10.1038/nmeth.2658</a></p>
<p>Anders, S. and Huber, W. (2010) Differential expression analysis for sequence count data. Genome Biology, 11, R106 <a href='https://doi.org/10.1186/gb-2010-11-10-r106'>https://doi.org/10.1186/gb-2010-11-10-r106</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>trichoptera</span>)
<span class='no'>counts</span> <span class='kw'>&lt;-</span> <span class='no'>trichoptera</span>$<span class='no'>Abundance</span>
<span class='fu'>compute_offset</span>(<span class='no'>counts</span>)</div><div class='output co'>#&gt;    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 
#&gt;   29   13   38  192   79   18    8   34   12    4    4    3   49   33  600  172 
#&gt;   17   18   19   20   21   22   23   24   25   26   27   28   29   30   31   32 
#&gt;   58   51   56  127   35   13   17    3   27   40   44    8    9 1599 2980   88 
#&gt;   33   34   35   36   37   38   39   40   41   42   43   44   45   46   47   48 
#&gt;  135  327   66   90   63   15   14   20   70   53   95   43   62  149   16   31 
#&gt;   49 
#&gt;   86 </div><div class='input'><span class='co'>## Other normalization schemes</span>
<span class='fu'>compute_offset</span>(<span class='no'>counts</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='st'>"GMPR"</span>)</div><div class='output co'>#&gt;  [1]  0.5808301  0.5527895  0.3237539  1.3108117  0.8377992  0.3519896
#&gt;  [7]  0.3480463  0.4473427  0.8240140  0.2102193  0.2417350  0.4792073
#&gt; [13]  0.5617223  0.5626398  6.7233230  1.9539350  0.6789666  0.9708882
#&gt; [19]  1.3048896  2.7954398  0.7849527  0.2390629  0.3191927  0.1765953
#&gt; [25]  0.4280917  0.7323014  0.6268829  0.1074211  0.1432622 13.4141528
#&gt; [31] 17.1399945  1.5216545  2.4971909  4.3163554  1.4396566  1.2444733
#&gt; [37]  1.3477580  0.3869058  0.3514524  0.5822573  1.3701441  1.1127722
#&gt; [43]  0.8582550  0.7646813  1.6970049  2.6515814  0.3343895  0.7587955
#&gt; [49]  0.9715722</div><div class='input'><span class='fu'>compute_offset</span>(<span class='no'>counts</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='st'>"RLE"</span>, <span class='kw'>pseudocounts</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='output co'>#&gt;         1         2         3         4         5         6         7         8 
#&gt; 0.9186270 0.8349121 0.8570257 0.9186270 0.9186270 0.8349121 0.8192245 0.8570257 
#&gt;         9        10        11        12        13        14        15        16 
#&gt; 0.7322797 0.7322797 0.6321923 0.6321923 0.9240361 0.9186270 1.3788037 0.9240361 
#&gt;        17        18        19        20        21        22        23        24 
#&gt; 0.9186270 0.9240361 0.9240361 1.7140514 0.8908577 0.8570257 0.8349121 0.6321923 
#&gt;        25        26        27        28        29        30        31        32 
#&gt; 0.9240361 0.9240361 0.9186270 0.8570257 0.8349121 2.7721084 3.2934218 0.9584503 
#&gt;        33        34        35        36        37        38        39        40 
#&gt; 1.0406547 0.9584503 0.9584503 0.9186270 0.9584503 0.8908577 0.8349121 0.7322797 
#&gt;        41        42        43        44        45        46        47        48 
#&gt; 0.9240361 0.9240361 0.9584503 0.9584503 1.2643846 1.7140514 0.8233555 0.8908577 
#&gt;        49 
#&gt; 0.9186270 </div><div class='input'><span class='co'>## User supplied offsets</span>
<span class='no'>my_offset</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>counts</span>)), <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>counts</span>))
<span class='fu'>compute_offset</span>(<span class='no'>counts</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='no'>my_offset</span>)</div><div class='output co'>#&gt;    Che Hyc Hym Hys Psy Aga Glo Ath Cea Ced Set All Han Hfo Hsp Hve Sta
#&gt; 1    1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 2    1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 3    1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 4    1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 5    1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 6    1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 7    1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 8    1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 9    1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 10   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 11   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 12   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 13   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 14   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 15   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 16   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 17   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 18   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 19   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 20   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 21   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 22   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 23   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 24   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 25   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 26   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 27   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 28   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 29   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 30   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 31   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 32   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 33   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 34   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 35   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 36   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 37   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 38   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 39   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 40   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 41   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 42   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 43   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 44   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 45   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 46   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 47   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 48   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
#&gt; 49   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Julien Chiquet, Mahendra Mariadassou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


