<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sparse structure estimation for multivariate count data with PLN-network ‚Ä¢ PLNmodels</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sparse structure estimation for multivariate count data with PLN-network">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PLNmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://pln-team.github.io/slideshow/slides" class="external-link">Slideshow on PLN</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Trichoptera.html">The trichoptera data set</a>
    </li>
    <li>
      <a href="../articles/Import_data.html">Data importation in PLNmodels</a>
    </li>
    <li>
      <a href="../articles/PLN.html">PLN: Multivariate Poisson regression</a>
    </li>
    <li>
      <a href="../articles/PLNPCA.html">PLNPCA: Dimension Reduction</a>
    </li>
    <li>
      <a href="../articles/PLNnetwork.html">PLNnetwork: sparse structure inference</a>
    </li>
    <li>
      <a href="../articles/PLNLDA.html">PLNLDA: Discriminant Analysis</a>
    </li>
    <li>
      <a href="../articles/PLNmixture.html">PLNmixture: Model-based clustering for counts</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pln-team/PLNmodels/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Sparse structure estimation for multivariate
count data with PLN-network</h1>
                        <h4 data-toc-skip class="author">PLN team</h4>
            
            <h4 data-toc-skip class="date">2024-09-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/pln-team/PLNmodels/blob/master/vignettes/PLNnetwork.Rmd" class="external-link"><code>vignettes/PLNnetwork.Rmd</code></a></small>
      <div class="hidden name"><code>PLNnetwork.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="preliminaries">Preliminaries<a class="anchor" aria-label="anchor" href="#preliminaries"></a>
</h2>
<p>This vignette illustrates the standard use of the
<code>PLNnetwork</code> function and the methods accompanying the R6
Classes <code>PLNnetworkfamily</code> and
<code>PLNnetworkfit</code>.</p>
<div class="section level3">
<h3 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h3>
<p>The packages required for the analysis are <strong>PLNmodels</strong>
plus some others for data manipulation and representation:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pln-team.github.io/PLNmodels/">PLNmodels</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-set">Data set<a class="anchor" aria-label="anchor" href="#data-set"></a>
</h3>
<p>We illustrate our point with the trichoptera data set, a full
description of which can be found in <a href="Trichoptera.html">the
corresponding vignette</a>. Data preparation is also detailed in <a href="Import_data.html">the specific vignette</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">trichoptera</span><span class="op">)</span></span>
<span><span class="va">trichoptera</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_data</a></span><span class="op">(</span><span class="va">trichoptera</span><span class="op">$</span><span class="va">Abundance</span>, <span class="va">trichoptera</span><span class="op">$</span><span class="va">Covariate</span><span class="op">)</span></span></code></pre></div>
<p>The <code>trichoptera</code> data frame stores a matrix of counts
(<code>trichoptera$Abundance</code>), a matrix of offsets
(<code>trichoptera$Offset</code>) and some vectors of covariates
(<code>trichoptera$Wind</code>, <code>trichoptera$Temperature</code>,
etc.)</p>
</div>
<div class="section level3">
<h3 id="mathematical-background">Mathematical background<a class="anchor" aria-label="anchor" href="#mathematical-background"></a>
</h3>
<p>The network model for multivariate count data that we introduce in
<span class="citation">Chiquet, Robin, and Mariadassou (<a href="#ref-PLNnetwork">2019</a>)</span> is a variant of the Poisson
Lognormal model of <span class="citation">Aitchison and Ho (<a href="#ref-AiH89">1989</a>)</span>, see <a href="PLN.html">the PLN
vignette</a> as a reminder. Compare to the standard PLN model we add a
sparsity constraint on the inverse covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ùö∫</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚âú</mo><mi>ùõÄ</mi></mrow><annotation encoding="application/x-tex">{\boldsymbol\Sigma}^{-1}\triangleq \boldsymbol\Omega</annotation></semantics></math>
by means of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>‚Ñì</mo><mn>1</mn></msub><annotation encoding="application/x-tex">\ell_1</annotation></semantics></math>-norm,
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">‚à•</mo><mi>ùõÄ</mi><msub><mo stretchy="false" form="postfix">‚à•</mo><mn>1</mn></msub><mo>&lt;</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">\|\boldsymbol\Omega\|_1 &lt; c</annotation></semantics></math>.
PLN-network is the equivalent of the sparse multivariate Gaussian model
<span class="citation">(<a href="#ref-banerjee2008">Banerjee, Ghaoui,
and d‚ÄôAspremont 2008</a>)</span> in the PLN framework. It relates some
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-dimensional
observation vectors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêò</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathbf{Y}_i</annotation></semantics></math>
to some
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-dimensional
vectors of Gaussian latent variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêô</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathbf{Z}_i</annotation></semantics></math>
as follows
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">latent space </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ùêô</mi><mi>i</mi></msub><mo>‚àº</mo><mi>ùí©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ùõç</mi><mo>,</mo><msup><mi>ùõÄ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo stretchy="false" form="postfix">‚à•</mo><mi>ùõÄ</mi><msub><mo stretchy="false" form="postfix">‚à•</mo><mn>1</mn></msub><mo>&lt;</mo><mi>c</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">observation space </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mspace width="1.0em"></mspace><mtext mathvariant="normal">indep.</mtext></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>‚àº</mo><mi>ùí´</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>exp</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">}</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} 
  \begin{array}{rcl}
  \text{latent space } &amp;   \mathbf{Z}_i \sim \mathcal{N}\left({\boldsymbol\mu},\boldsymbol\Omega^{-1}\right) &amp;  \|\boldsymbol\Omega\|_1 &lt; c \\
  \text{observation space } &amp;  Y_{ij} | Z_{ij} \quad \text{indep.} &amp; Y_{ij} | Z_{ij} \sim \mathcal{P}\left(\exp\{Z_{ij}\}\right)
  \end{array}
\end{equation}</annotation></semantics></math></p>
<p>The parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõç</mi><annotation encoding="application/x-tex">{\boldsymbol\mu}</annotation></semantics></math>
corresponds to the main effects and the latent covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùö∫</mi><annotation encoding="application/x-tex">\boldsymbol\Sigma</annotation></semantics></math>
describes the underlying structure of dependence between the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
variables.</p>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>‚Ñì</mo><mn>1</mn></msub><annotation encoding="application/x-tex">\ell_1</annotation></semantics></math>-penalty
on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÄ</mi><annotation encoding="application/x-tex">\boldsymbol\Omega</annotation></semantics></math>
induces sparsity and selection of important direct relationships between
entities. Hence, the support of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÄ</mi><annotation encoding="application/x-tex">\boldsymbol\Omega</annotation></semantics></math>
correspond to a network of underlying interactions. The sparsity level
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
in the above mathematical model), which corresponds to the number of
edges in the network, is controlled by a penalty parameter in the
optimization process sometimes referred to as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>.
All mathematical details can be found in <span class="citation">Chiquet,
Robin, and Mariadassou (<a href="#ref-PLNnetwork">2019</a>)</span>.</p>
<div class="section level4">
<h4 id="covariates-and-offsets">Covariates and offsets<a class="anchor" aria-label="anchor" href="#covariates-and-offsets"></a>
</h4>
<p>Just like PLN, PLN-network generalizes to a formulation close to a
multivariate generalized linear model where the main effect is due to a
linear combination of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùê±</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathbf{x}_i</annotation></semantics></math>
and to a vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùê®</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathbf{o}_i</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
offsets in sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
The latent layer then reads
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêô</mi><mi>i</mi></msub><mo>‚àº</mo><mi>ùí©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><msub><mi>ùê®</mi><mi>i</mi></msub><mo>+</mo><msubsup><mi>ùê±</mi><mi>i</mi><mi>‚ä§</mi></msubsup><mi>ùêÅ</mi></mrow><mo>,</mo><msup><mi>ùõÄ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="2.0em"></mspace><mo stretchy="false" form="postfix">‚à•</mo><mi>ùõÄ</mi><msub><mo stretchy="false" form="postfix">‚à•</mo><mn>1</mn></msub><mo>&lt;</mo><mi>c</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation} 
  \mathbf{Z}_i \sim \mathcal{N}\left({\mathbf{o}_i + \mathbf{x}_i^\top\mathbf{B}},\boldsymbol\Omega^{-1}\right), \qquad \|\boldsymbol\Omega\|_1 &lt; c ,
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÅ</mi><annotation encoding="application/x-tex">\mathbf{B}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>√ó</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">d\times p</annotation></semantics></math>
matrix of regression parameters.</p>
</div>
<div class="section level4">
<h4 id="alternating-optimization">Alternating optimization<a class="anchor" aria-label="anchor" href="#alternating-optimization"></a>
</h4>
<p>Regularization via sparsification of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÄ</mi><annotation encoding="application/x-tex">\boldsymbol\Omega</annotation></semantics></math>
and visualization of the consecutive network is the main objective in
PLN-network. To reach this goal, we need to first estimate the model
parameters. Inference in PLN-network focuses on the regression
parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÅ</mi><annotation encoding="application/x-tex">\mathbf{B}</annotation></semantics></math>
and the inverse covariance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÄ</mi><annotation encoding="application/x-tex">\boldsymbol\Omega</annotation></semantics></math>.
Technically speaking, we adopt a variational strategy to approximate the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>‚Ñì</mo><mn>1</mn></msub><annotation encoding="application/x-tex">\ell_1</annotation></semantics></math>-penalized
log-likelihood function and optimize the consecutive sparse variational
surrogate with an optimization scheme that alternates between two
step</p>
<ol style="list-style-type: decimal">
<li>a gradient-ascent-step, performed with the CCSA algorithm of <span class="citation">Svanberg (<a href="#ref-Svan02">2002</a>)</span>
implemented in the C++ library <span class="citation">(<a href="#ref-nlopt">Johnson 2011</a>)</span>, which we link to the
package.</li>
<li>a penalized log-likelihood step, performed with the graphical-Lasso
of <span class="citation">Friedman, Hastie, and Tibshirani (<a href="#ref-FHT08">2008</a>)</span>, implemented in the package
<strong>fastglasso</strong> <span class="citation">(<a href="#ref-glassofast">Sustik and Calderhead 2012</a>)</span>.</li>
</ol>
<p>More technical details can be found in <span class="citation">Chiquet, Robin, and Mariadassou (<a href="#ref-PLNnetwork">2019</a>)</span></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="analysis-of-trichoptera-data-with-a-plnnetwork-model">Analysis of trichoptera data with a PLNnetwork model<a class="anchor" aria-label="anchor" href="#analysis-of-trichoptera-data-with-a-plnnetwork-model"></a>
</h2>
<p>In the package, the sparse PLN-network model is adjusted with the
function <code>PLNnetwork</code>, which we review in this section. This
function adjusts the model for a series of value of the penalty
parameter controlling the number of edges in the network. It then
provides a collection of objects with class <code>PLNnetworkfit</code>,
corresponding to networks with different levels of density, all stored
in an object with class <code>PLNnetworkfamily</code>.</p>
<div class="section level3">
<h3 id="adjusting-a-collection-of-network---a-k-a--a-regularization-path">Adjusting a collection of network - a.k.a. a regularization
path<a class="anchor" aria-label="anchor" href="#adjusting-a-collection-of-network---a-k-a--a-regularization-path"></a>
</h3>
<p><code>PLNnetwork</code> finds an hopefully appropriate set of
penalties on its own. This set can be controlled by the user, but use it
with care and check details in <code><a href="../reference/PLNnetwork.html">?PLNnetwork</a></code>. The collection
of models is fitted as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">network_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PLNnetwork.html">PLNnetwork</a></span><span class="op">(</span><span class="va">Abundance</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Offset</span><span class="op">)</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">trichoptera</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Initialization...</span></span>
<span><span class="co">##  Adjusting 30 PLN with sparse inverse covariance estimation</span></span>
<span><span class="co">##  Joint optimization alternating gradient descent and graphical-lasso</span></span>
<span><span class="co">##  sparsifying penalty = 3.643028  sparsifying penalty = 3.364959  sparsifying penalty = 3.108114  sparsifying penalty = 2.870875  sparsifying penalty = 2.651743  sparsifying penalty = 2.449338  sparsifying penalty = 2.262382  sparsifying penalty = 2.089696  sparsifying penalty = 1.930192  sparsifying penalty = 1.782862  sparsifying penalty = 1.646778  sparsifying penalty = 1.52108   sparsifying penalty = 1.404978  sparsifying penalty = 1.297737  sparsifying penalty = 1.198682  sparsifying penalty = 1.107187  sparsifying penalty = 1.022677  sparsifying penalty = 0.9446167     sparsifying penalty = 0.8725149     sparsifying penalty = 0.8059166     sparsifying penalty = 0.7444017     sparsifying penalty = 0.6875821     sparsifying penalty = 0.6350996     sparsifying penalty = 0.586623  sparsifying penalty = 0.5418465     sparsifying penalty = 0.5004879     sparsifying penalty = 0.4622861     sparsifying penalty = 0.4270002     sparsifying penalty = 0.3944076     sparsifying penalty = 0.3643028 </span></span>
<span><span class="co">##  Post-treatments</span></span>
<span><span class="co">##  DONE!</span></span></code></pre>
<p>Note the use of the <code>formula</code> object to specify the model,
similar to the one used in the function <code>PLN</code>.</p>
</div>
<div class="section level3">
<h3 id="structure-of-plnnetworkfamily">Structure of <code>PLNnetworkfamily</code><a class="anchor" aria-label="anchor" href="#structure-of-plnnetworkfamily"></a>
</h3>
<p>The <code>network_models</code> variable is an <code>R6</code> object
with class <code>PLNnetworkfamily</code>, which comes with a couple of
methods. The most basic is the <code>show/print</code> method, which
sends a very basic summary of the estimation process:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">network_models</span></span></code></pre></div>
<pre><code><span><span class="co">## --------------------------------------------------------</span></span>
<span><span class="co">## COLLECTION OF 30 POISSON LOGNORMAL MODELS</span></span>
<span><span class="co">## --------------------------------------------------------</span></span>
<span><span class="co">##  Task: Network Inference </span></span>
<span><span class="co">## ========================================================</span></span>
<span><span class="co">##  - 30 penalties considered: from 0.3643028 to 3.643028 </span></span>
<span><span class="co">##  - Best model (greater BIC): lambda = 0.5 </span></span>
<span><span class="co">##  - Best model (greater EBIC): lambda = 0.873</span></span></code></pre>
<p>One can also easily access the successive values of the criteria in
the collection</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">network_models</span><span class="op">$</span><span class="va">criteria</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="9%">
<col width="9%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="8%">
<col width="10%">
<col width="11%">
<col width="10%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="right">param</th>
<th align="right">nb_param</th>
<th align="right">loglik</th>
<th align="right">BIC</th>
<th align="right">ICL</th>
<th align="right">n_edges</th>
<th align="right">EBIC</th>
<th align="right">pen_loglik</th>
<th align="right">density</th>
<th align="left">stability</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">3.643028</td>
<td align="right">34</td>
<td align="right">-1286.240</td>
<td align="right">-1352.401</td>
<td align="right">-2786.880</td>
<td align="right">0</td>
<td align="right">-1352.401</td>
<td align="right">-1292.857</td>
<td align="right">0.0000000</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">3.364959</td>
<td align="right">34</td>
<td align="right">-1280.386</td>
<td align="right">-1346.546</td>
<td align="right">-2781.026</td>
<td align="right">0</td>
<td align="right">-1346.546</td>
<td align="right">-1286.727</td>
<td align="right">0.0000000</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">3.108114</td>
<td align="right">34</td>
<td align="right">-1274.915</td>
<td align="right">-1341.076</td>
<td align="right">-2775.554</td>
<td align="right">0</td>
<td align="right">-1341.076</td>
<td align="right">-1280.987</td>
<td align="right">0.0000000</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">2.870875</td>
<td align="right">34</td>
<td align="right">-1269.806</td>
<td align="right">-1335.967</td>
<td align="right">-2770.442</td>
<td align="right">0</td>
<td align="right">-1335.967</td>
<td align="right">-1275.615</td>
<td align="right">0.0000000</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">2.651743</td>
<td align="right">35</td>
<td align="right">-1264.816</td>
<td align="right">-1332.923</td>
<td align="right">-2767.393</td>
<td align="right">1</td>
<td align="right">-1335.380</td>
<td align="right">-1270.378</td>
<td align="right">0.0069204</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">2.449338</td>
<td align="right">35</td>
<td align="right">-1260.124</td>
<td align="right">-1328.231</td>
<td align="right">-2762.693</td>
<td align="right">1</td>
<td align="right">-1330.687</td>
<td align="right">-1265.445</td>
<td align="right">0.0069204</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p>A diagnostic of the optimization process is available via the
<code>convergence</code> field:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">network_models</span><span class="op">$</span><span class="va">convergence</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="8%">
<col width="12%">
<col width="12%">
<col width="9%">
<col width="10%">
<col width="13%">
<col width="15%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">param</th>
<th align="left">nb_param</th>
<th align="left">status</th>
<th align="left">backend</th>
<th align="left">objective</th>
<th align="left">iterations</th>
<th align="left">convergence</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">out</td>
<td align="right">3.643028</td>
<td align="left">34</td>
<td align="left">3</td>
<td align="left">nlopt</td>
<td align="left">1286.24</td>
<td align="left">6</td>
<td align="left">6.632337e-08</td>
</tr>
<tr class="even">
<td align="left">elt</td>
<td align="right">3.364959</td>
<td align="left">34</td>
<td align="left">3</td>
<td align="left">nlopt</td>
<td align="left">1280.386</td>
<td align="left">2</td>
<td align="left">3.808919e-08</td>
</tr>
<tr class="odd">
<td align="left">elt.1</td>
<td align="right">3.108114</td>
<td align="left">34</td>
<td align="left">3</td>
<td align="left">nlopt</td>
<td align="left">1274.915</td>
<td align="left">2</td>
<td align="left">1.486332e-07</td>
</tr>
<tr class="even">
<td align="left">elt.2</td>
<td align="right">2.870875</td>
<td align="left">34</td>
<td align="left">3</td>
<td align="left">nlopt</td>
<td align="left">1269.806</td>
<td align="left">2</td>
<td align="left">2.926876e-07</td>
</tr>
<tr class="odd">
<td align="left">elt.3</td>
<td align="right">2.651743</td>
<td align="left">35</td>
<td align="left">3</td>
<td align="left">nlopt</td>
<td align="left">1264.816</td>
<td align="left">2</td>
<td align="left">5.343262e-07</td>
</tr>
<tr class="even">
<td align="left">elt.4</td>
<td align="right">2.449338</td>
<td align="left">35</td>
<td align="left">3</td>
<td align="left">nlopt</td>
<td align="left">1260.124</td>
<td align="left">2</td>
<td align="left">1.007756e-06</td>
</tr>
</tbody>
</table>
<p>An nicer view of this output comes with the option ‚Äúdiagnostic‚Äù in
the <code>plot</code> method:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">network_models</span>, <span class="st">"diagnostic"</span><span class="op">)</span></span></code></pre></div>
<p><img src="PLNnetwork_files/figure-html/diagnostic-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="exploring-the-path-of-networks">Exploring the path of networks<a class="anchor" aria-label="anchor" href="#exploring-the-path-of-networks"></a>
</h3>
<p>By default, the <code>plot</code> method of
<code>PLNnetworkfamily</code> displays evolution of the criteria
mentioned above, and is a good starting point for model selection:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">network_models</span><span class="op">)</span></span></code></pre></div>
<p><img src="PLNnetwork_files/figure-html/plot-1.png" width="672"></p>
<p>Note that we use the original definition of the BIC/ICL criterion
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">ùöïùöòùöêùöïùöíùöî</mtext><mo>‚àí</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mtext mathvariant="monospace">ùöôùöéùöó</mtext></mrow><annotation encoding="application/x-tex">\texttt{loglik} - \frac{1}{2}\texttt{pen}</annotation></semantics></math>),
which is on the same scale as the log-likelihood. A <a href="https://en.wikipedia.org/wiki/Bayesian_information_criterion" class="external-link">popular
alternative</a> consists in using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àí</mo><mn>2</mn><mtext mathvariant="monospace">ùöïùöòùöêùöïùöíùöî</mtext><mo>+</mo><mtext mathvariant="monospace">ùöôùöéùöó</mtext></mrow><annotation encoding="application/x-tex">-2\texttt{loglik} + \texttt{pen}</annotation></semantics></math>
instead. You can do so by specifying <code>reverse = TRUE</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">network_models</span>, reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="PLNnetwork_files/figure-html/plot-reverse-1.png" width="672"></p>
<p>In this case, the variational lower bound of the log-likelihood is
hopefully strictly increasing (or rather decreasing if using
<code>reverse = TRUE</code>) with a lower level of penalty (meaning more
edges in the network). The same holds true for the penalized counterpart
of the variational surrogate. Generally, smoothness of these criteria is
a good sanity check of optimization process. BIC and its
extended-version high-dimensional version EBIC are classically used for
selecting the correct amount of penalization with sparse estimator like
the one used by PLN-network. However, we will consider later a more
robust albeit more computationally intensive strategy to chose the
appropriate number of edges in the network.</p>
<p>To pursue the analysis, we can represent the coefficient path (i.e.,
value of the edges in the network according to the penalty level) to see
if some edges clearly come off. An alternative and more intuitive view
consists in plotting the values of the partial correlations along the
path, which can be obtained with the options <code>corr = TRUE</code>.
To this end, we provide the S3 function
<code>coefficient_path</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/coefficient_path.html">coefficient_path</a></span><span class="op">(</span><span class="va">network_models</span>, corr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Penalty</span>, y <span class="op">=</span> <span class="va">Coeff</span>, group <span class="op">=</span> <span class="va">Edge</span>, colour <span class="op">=</span> <span class="va">Edge</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_trans.html" class="external-link">coord_trans</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"log10"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="PLNnetwork_files/figure-html/path_coeff-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="model-selection-issue-choosing-a-network">Model selection issue: choosing a network<a class="anchor" aria-label="anchor" href="#model-selection-issue-choosing-a-network"></a>
</h3>
<p>To select a network with a specific level of penalty, one uses the
<code>getModel(lambda)</code> S3 method. We can also extract the best
model according to the BIC or EBIC with the method
<code><a href="../reference/getBestModel.html">getBestModel()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_pen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getModel.html">getModel</a></span><span class="op">(</span><span class="va">network_models</span>, <span class="va">network_models</span><span class="op">$</span><span class="va">penalties</span><span class="op">[</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span> <span class="co"># give some sparsity</span></span>
<span><span class="va">model_BIC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getBestModel.html">getBestModel</a></span><span class="op">(</span><span class="va">network_models</span>, <span class="st">"BIC"</span><span class="op">)</span>   <span class="co"># if no criteria is specified, the best BIC is used</span></span></code></pre></div>
<p>An alternative strategy is to use StARS <span class="citation">(<a href="#ref-stars">Liu, Roeder, and Wasserman 2010</a>)</span>, which
performs resampling to evaluate the robustness of the network along the
path of solutions in a similar fashion as the stability selection
approach of <span class="citation">Meinshausen and B√ºhlmann (<a href="#ref-stabilitySelection">2010</a>)</span>, but in a network
inference context.</p>
<p>Resampling can be computationally demanding but is easily
parallelized: the function <code>stability_selection</code> integrates
some features of the <strong>future</strong> package to perform parallel
computing. We set our plan to speed the process by relying on 2
workers:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>We first invoke <code>stability_selection</code> explicitly for
pedagogical purpose. In this case, we need to build our sub-samples
manually:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">trichoptera</span><span class="op">)</span></span>
<span><span class="va">subs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/stability_selection.html">stability_selection</a></span><span class="op">(</span><span class="va">network_models</span>, subsamples <span class="op">=</span> <span class="va">subs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Stability Selection for PLNnetwork: </span></span>
<span><span class="co">## subsampling: ++++++++++</span></span></code></pre>
<p>Requesting ‚ÄòStARS‚Äô in <code>gestBestmodel</code> automatically
invokes <code>stability_selection</code> with 20 sub-samples, if it has
not yet been run.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_StARS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getBestModel.html">getBestModel</a></span><span class="op">(</span><span class="va">network_models</span>, <span class="st">"StARS"</span><span class="op">)</span></span></code></pre></div>
<p>When ‚ÄúStARS‚Äù is requested for the first time,
<code>getBestModel</code> automatically calls the method
<code>stability_selection</code> with the default parameters. After the
first call, the stability path is available from the <code>plot</code>
function:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">network_models</span>, <span class="st">"stability"</span><span class="op">)</span></span></code></pre></div>
<p><img src="PLNnetwork_files/figure-html/plot%20stability-1.png" width="672"></p>
<p>When you are done, do not forget to get back to the standard
sequential plan with <em>future</em>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="st">"sequential"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="structure-of-a-plnnetworkfit">Structure of a <code>PLNnetworkfit</code><a class="anchor" aria-label="anchor" href="#structure-of-a-plnnetworkfit"></a>
</h3>
<p>The variables <code>model_BIC</code>, <code>model_StARS</code> and
<code>model_pen</code> are other <code>R6Class</code> objects with class
<code>PLNnetworkfit</code>. They all inherits from the class
<code>PLNfit</code> and thus own all its methods, with a couple of
specific one, mostly for network visualization purposes. Most fields and
methods are recalled when such an object is printed:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_StARS</span></span></code></pre></div>
<pre><code><span><span class="co">## Poisson Lognormal with sparse inverse covariance (penalty = 1.3)</span></span>
<span><span class="co">## ==================================================================</span></span>
<span><span class="co">##  nb_param    loglik       BIC       ICL n_edges      EBIC pen_loglik density</span></span>
<span><span class="co">##        35 -1210.266 -1278.373 -2668.246       1 -1280.829  -1214.445   0.007</span></span>
<span><span class="co">## ==================================================================</span></span>
<span><span class="co">## * Useful fields</span></span>
<span><span class="co">##     $model_par, $latent, $latent_pos, $var_par, $optim_par</span></span>
<span><span class="co">##     $loglik, $BIC, $ICL, $loglik_vec, $nb_param, $criteria</span></span>
<span><span class="co">## * Useful S3 methods</span></span>
<span><span class="co">##     print(), coef(), sigma(), vcov(), fitted()</span></span>
<span><span class="co">##     predict(), predict_cond(), standard_error()</span></span>
<span><span class="co">## * Additional fields for sparse network</span></span>
<span><span class="co">##     $EBIC, $density, $penalty </span></span>
<span><span class="co">## * Additional S3 methods for network</span></span>
<span><span class="co">##     plot.PLNnetworkfit()</span></span></code></pre>
<p>The <code>plot</code> method provides a quick representation of the
inferred network, with various options (either as a matrix, a graph, and
always send back the plotted object invisibly if users needs to perform
additional analyses).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_StARS</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">my_graph</span></span></code></pre></div>
<pre><code><span><span class="co">## IGRAPH 82791d8 UNW- 17 1 -- </span></span>
<span><span class="co">## + attr: name (v/c), label (v/c), label.cex (v/n), size (v/n),</span></span>
<span><span class="co">## | label.color (v/c), frame.color (v/l), weight (e/n), color (e/c),</span></span>
<span><span class="co">## | width (e/n)</span></span>
<span><span class="co">## + edge from 82791d8 (vertex names):</span></span>
<span><span class="co">## [1] Hfo--Hsp</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_StARS</span><span class="op">)</span></span></code></pre></div>
<p><img src="PLNnetwork_files/figure-html/stars_network-1.png" width="672"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_StARS</span>, type <span class="op">=</span> <span class="st">"support"</span>, output <span class="op">=</span> <span class="st">"corrplot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="PLNnetwork_files/figure-html/stars_network-2.png" width="672"></p>
<p>We can finally check that the fitted value of the counts ‚Äì even with
sparse regularization of the covariance matrix ‚Äì are close to the
observed ones:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  fitted   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">model_StARS</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">trichoptera</span><span class="op">$</span><span class="va">Abundance</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">observed</span>, y <span class="op">=</span> <span class="va">fitted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.5</span>, alpha <span class="op">=</span><span class="fl">.25</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_logticks.html" class="external-link">annotation_logticks</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="PLNnetwork_files/figure-html/fitted-1.png" alt="fitted value vs. observation" width="672"><p class="caption">
fitted value vs.¬†observation
</p>
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-AiH89" class="csl-entry">
Aitchison, J., and C. H. Ho. 1989. <span>‚ÄúThe Multivariate Poisson-Log
Normal Distribution.‚Äù</span> <em>Biometrika</em> 76 (4): 643‚Äì53.
</div>
<div id="ref-banerjee2008" class="csl-entry">
Banerjee, Onureena, Laurent El Ghaoui, and Alexandre d‚ÄôAspremont. 2008.
<span>‚ÄúModel Selection Through Sparse Maximum Likelihood Estimation for
Multivariate Gaussian or Binary Data.‚Äù</span> <em>Journal of Machine
Learning Research</em> 9 (Mar): 485‚Äì516.
</div>
<div id="ref-PLNnetwork" class="csl-entry">
Chiquet, Julien, Stephane Robin, and Mahendra Mariadassou. 2019.
<span>‚ÄúVariational Inference for Sparse Network Reconstruction from
Count Data.‚Äù</span> In <em>Proceedings of the 36th International
Conference on Machine Learning</em>, edited by Kamalika Chaudhuri and
Ruslan Salakhutdinov, 97:1162‚Äì71. Proceedings of Machine Learning
Research. Long Beach, California, USA: PMLR. <a href="http://proceedings.mlr.press/v97/chiquet19a.html" class="external-link">http://proceedings.mlr.press/v97/chiquet19a.html</a>.
</div>
<div id="ref-FHT08" class="csl-entry">
Friedman, J., T. Hastie, and R. Tibshirani. 2008. <span>‚ÄúSparse Inverse
Covariance Estimation with the Graphical Lasso.‚Äù</span>
<em>Biostatistics</em> 9 (3): 432‚Äì41.
</div>
<div id="ref-nlopt" class="csl-entry">
Johnson, Steven G. 2011. <em>The NLopt Nonlinear-Optimization
Package</em>. <a href="https://nlopt.readthedocs.io/en/latest/" class="external-link">https://nlopt.readthedocs.io/en/latest/</a>.
</div>
<div id="ref-stars" class="csl-entry">
Liu, Han, Kathryn Roeder, and Larry Wasserman. 2010. <span>‚ÄúStability
Approach to Regularization Selection (StARS) for High Dimensional
Graphical Models.‚Äù</span> In <em>Proceedings of the 23rd International
Conference on Neural Information Processing Systems - Volume 2</em>,
1432‚Äì40. USA.
</div>
<div id="ref-stabilitySelection" class="csl-entry">
Meinshausen, Nicolai, and Peter B√ºhlmann. 2010. <span>‚ÄúStability
Selection.‚Äù</span> <em>Journal of the Royal Statistical Society: Series
B (Statistical Methodology)</em> 72 (4): 417‚Äì73.
</div>
<div id="ref-glassofast" class="csl-entry">
Sustik, M√°ty√°s A, and Ben Calderhead. 2012. <span>‚ÄúGLASSOFAST: An
Efficient GLASSO Implementation.‚Äù</span> <em>UTCS Technical Report
TR-12-29 2012</em>.
</div>
<div id="ref-Svan02" class="csl-entry">
Svanberg, Krister. 2002. <span>‚ÄúA Class of Globally Convergent
Optimization Methods Based on Conservative Convex Separable
Approximations.‚Äù</span> <em>SIAM Journal on Optimization</em> 12 (2):
555‚Äì73.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Julien Chiquet, Mahendra Mariadassou, St√©phane Robin, Fran√ßois Gindraud.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
